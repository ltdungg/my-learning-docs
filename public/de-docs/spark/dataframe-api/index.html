<!doctype html>
<html lang="en" data-bs-theme="auto">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><link rel="preload" href="http://localhost:1313/fonts/vendor/jost/jost-v4-latin-regular.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="http://localhost:1313/fonts/vendor/jost/jost-v4-latin-500.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="http://localhost:1313/fonts/vendor/jost/jost-v4-latin-700.woff2" as="font" type="font/woff2" crossorigin>
<script 
  src="/js/color-mode.f14b3e296de1d0b69e75af684b62a4a912a2cadab04e36123407cd8388204f1d.js"
  integrity="sha256-8Us&#43;KW3h0Laeda9oS2KkqRKiytqwTjYSNAfNg4ggTx0=">
</script>


<link rel="stylesheet" href="/main.1ea200a148900b4ef26b26e3b271c96a294dcdb263801118c87701392136b178950c75cff47f03aea473a8f412260091163f6e9c438d2dfe4422ad719b0c4ac2.css" integrity="sha512-HqIAoUiQC07yaybjsnHJailNzbJjgBEYyHcBOSE2sXiVDHXP9H8DrqRzqPQSJgCRFj9unEONLf5EIq1xmwxKwg==" crossorigin="anonymous">

<noscript><style>img.lazyload { display: none; }</style></noscript><base href="http://localhost:1313/de-docs/spark/dataframe-api/">

  <link rel="canonical" href="http://localhost:1313/de-docs/spark/dataframe-api/">


<title>5. DataFrame API  |  Dũng&#39;s Blog</title>
<meta name="description" content="Congrats on setting up a new Doks project!">

    
    <link rel="icon" href="/favicon.ico" sizes="32x32">
    
      <link rel="icon" href="/favicon.svg" type="image/svg+xml">
    
      <link
        rel="apple-touch-icon"
        href="/apple-touch-icon.png"
        sizes="180x180"
        type="image/png"
      >
      <link
        rel="icon"
        href="/favicon-192x192.png"
        sizes="192x192"
        type="image/png"
      >
      <link
        rel="icon"
        href="/favicon-512x512.png"
        sizes="512x512"
        type="image/png"
      >
<link rel="manifest" href="/manifest.webmanifest">

<meta property="og:url" content="http://localhost:1313/de-docs/spark/dataframe-api/">
  <meta property="og:site_name" content="Dũng&#39;s Blog">
  <meta property="og:title" content="5. DataFrame API">
  <meta property="og:description" content="Spark DataFrame được lấy cảm hứng từ pandas DataFrame về cấu trúc, định dạng và một số thao tác cụ thể. Ví dụ về một Spark DataFrame được hiển thị tại Hình 1.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="de-docs">
    <meta property="article:published_time" content="2023-09-07T16:04:48+02:00">
    <meta property="article:modified_time" content="2025-01-27T18:57:07+07:00">
    <meta property="og:image" content="http://localhost:1313/cover.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/cover.png">
  <meta name="twitter:title" content="5. DataFrame API">
  <meta name="twitter:description" content="Spark DataFrame được lấy cảm hứng từ pandas DataFrame về cấu trúc, định dạng và một số thao tác cụ thể. Ví dụ về một Spark DataFrame được hiển thị tại Hình 1.">
      <meta name="twitter:site" content="@getdoks">

    
    
    <script type="application/ld+json">
  {
   "@context": "https://schema.org",
   "@type": "BreadcrumbList",
   "itemListElement": [
     {
       "@type": "ListItem",
       "item": "http://localhost:1313/",
       "name": "Kho Kiến Thức Của Dũng",
       "position": 1
     },
     {
       "@type": "ListItem",
       "item": "http://localhost:1313/de-docs/",
       "name": "De Docs",
       "position": 2
     },
     {
       "@type": "ListItem",
       "item": "http://localhost:1313/de-docs/spark/",
       "name": "Mở Đầu Về Spark",
       "position": 3
     },
     {
       "@type": "ListItem",
       "name": "5. Data Frame API",
       "position": 4
     }
   ]
 }
</script>





</head>

  
  <body class="single section de-docs" data-bs-spy="scroll" data-bs-target="#toc" data-bs-root-margin="0px 0px -60%" data-bs-smooth-scroll="true" tabindex="0">
    <div class="sticky-top">
<div class="header-bar"></div>
<header class="navbar navbar-expand-lg">
  <div class="container-lg">
  
    <a class="navbar-brand me-auto me-lg-3" href="/">Dũng&#39;s Blog</a>

    
    
    <button type="button" id="searchToggleMobile" class="btn btn-link nav-link mx-2 d-lg-none" aria-label="Search website">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <circle cx="10" cy="10" r="7"></circle>
        <line x1="21" y1="21" x2="15" y2="15"></line>
      </svg>
    </button>
    
    <button class="btn btn-link d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavSection" aria-controls="offcanvasNavSection" aria-label="Open section navigation menu">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-dots-vertical" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"></path>
        <path d="M12 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"></path>
        <path d="M12 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"></path>
      </svg>
    </button>
    <div class="offcanvas offcanvas-start d-lg-none" tabindex="-1" id="offcanvasNavSection" aria-labelledby="offcanvasNavSectionLabel">
      <div class="header-bar"></div>
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasNavSectionLabel">De docs</h5>
        <button type="button" class="btn btn-link nav-link p-0 ms-auto" data-bs-dismiss="offcanvas" aria-label="Close">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <path d="M18 6l-12 12"></path>
            <path d="M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      <div class="offcanvas-body">
        <aside class="doks-sidebar mt-n3">
          <nav id="doks-docs-nav" aria-label="Tertiary navigation">
            
  
    
<nav class="section-nav docs-links">
  <ul class="list-unstyled">

  <li>
    <details open>
      <summary>Giới thiệu</summary>
      <ul class="list-unstyled list-nested">

  <li>
      <a href="/de-docs/overview/loi-mo-dau/">Lời mở đầu</a>
  </li>
      </ul>
    </details>
  </li>

  <li>
    <details open>
      <summary>Data Engineer Cơ Bản</summary>
      <ul class="list-unstyled list-nested">

  <li>
      <a href="/de-docs/de-basic/1-gioi-thieu-ve-de/">Giới thiệu về Data Engineer</a>
  </li>

  <li>
      <a href="/de-docs/de-basic/2-data-management-architecture/">Data Management Architectures</a>
  </li>

  <li>
    <details open>
      <summary>Data Warehouse</summary>
      <ul class="list-unstyled list-nested">

  <li>
      <a href="/de-docs/de-basic/datawarehouse/data-warehouse-basic/">Data Warehouse cơ bản</a>
  </li>

  <li>
      <a href="/de-docs/de-basic/datawarehouse/dtamsp/">Kho dữ liệu phân tán và xử lý dữ liệu song song</a>
  </li>

  <li>
      <a href="/de-docs/de-basic/datawarehouse/columnar-data-storage/">Columnar Data Storage And Data Compression</a>
  </li>

  <li>
      <a href="/de-docs/de-basic/datawarehouse/etl-elt-pipelines/">ETL and ELT pipelines</a>
  </li>
      </ul>
    </details>
  </li>

  <li>
    <details open>
      <summary>Data Lake</summary>
      <ul class="list-unstyled list-nested">

  <li>
      <a href="/de-docs/de-basic/datalake/overview/">Data Lake cơ bản</a>
  </li>
      </ul>
    </details>
  </li>

  <li>
    <details open>
      <summary>Data Lakehouse</summary>
      <ul class="list-unstyled list-nested">

  <li>
      <a href="/de-docs/de-basic/datalakehouse/overview/">Data lakehouse cơ bản</a>
  </li>
      </ul>
    </details>
  </li>

  <li>
    <details open>
      <summary>AWS for Ingesting Data</summary>
      <ul class="list-unstyled list-nested">

  <li>
      <a href="/de-docs/de-basic/ingestion-tool/overview/">Giới thiệu</a>
  </li>

  <li>
      <a href="/de-docs/de-basic/ingestion-tool/amazon-dms/">Amazon Database Migration Service</a>
  </li>

  <li>
      <a href="/de-docs/de-basic/ingestion-tool/amazon-kinesis/">Amazon Kinesis for streaming data ingestion</a>
  </li>
      </ul>
    </details>
  </li>
      </ul>
    </details>
  </li>

  <li>
    <details open open>
      <summary>Mở đầu về Spark</summary>
      <ul class="list-unstyled list-nested">

  <li>
      <a href="/de-docs/spark/khai-niem/">1. Giới thiệu về Spark</a>
  </li>

  <li>
      <a href="/de-docs/spark/thanh-phan-cua-spark/">2. Thành phần của Spark</a>
  </li>

  <li>
      <a href="/de-docs/spark/cach-hoat-dong/">3. Cách Spark hoạt động</a>
  </li>

  <li>
      <a href="/de-docs/spark/spark-application-concept/">4. Các khái niệm Spark Application</a>
  </li>

  <li class="active" >
      <a aria-current="page" href="/de-docs/spark/dataframe-api/">5. DataFrame API</a>
  </li>

  <li>
      <a href="/de-docs/spark/common-dataframe-operation/">6. Một số thao tác với DataFrame</a>
  </li>

  <li>
      <a href="/de-docs/spark/bai-tap-lan-mot/">7. Bài tập DataFrame lần 1</a>
  </li>
      </ul>
    </details>
  </li>

  <li>
    <details open>
      <summary>Mở đầu về Kafka</summary>
      <ul class="list-unstyled list-nested">

  <li>
      <a href="/de-docs/kafka/overview/">Giới thiệu về Kafka</a>
  </li>
      </ul>
    </details>
  </li>
  </ul>
</nav>

  

          </nav>
        </aside>
      </div>
    </div>
    
    <button class="btn btn-link nav-link mx-2 order-3 d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavMain" aria-controls="offcanvasNavMain" aria-label="Open main navigation menu">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <line x1="4" y1="8" x2="20" y2="8"></line>
        <line x1="4" y1="16" x2="20" y2="16"></line>
      </svg>
    </button>

    
    <div class="offcanvas offcanvas-end h-auto" tabindex="-1" id="offcanvasNavMain" aria-labelledby="offcanvasNavMainLabel">
      <div class="header-bar d-lg-none"></div>
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasNavMainLabel">Dũng&#39;s Blog</h5>
        <button type="button" class="btn btn-link nav-link p-0 ms-auto" data-bs-dismiss="offcanvas" aria-label="Close">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <path d="M18 6l-12 12"></path>
            <path d="M6 6l12 12"></path>
         </svg>
        </button>
      </div>
      
      <div class="offcanvas-body d-flex flex-column flex-lg-row justify-content-between">
        <ul class="navbar-nav flex-grow-1"><li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/docs/overview/l%E1%BB%9Di-m%E1%BB%9F-%C4%91%E1%BA%A7u/">Tài liệu AWS</a>
              </li>
            <li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/de-docs/overview/loi-mo-dau/">Tài liệu Data Engineer</a>
              </li>
            <li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/blog/">Bài viết</a>
              </li>
            </ul>

        
        
        <button type="button" id="searchToggleDesktop" class="btn btn-link nav-link p-2 d-none d-lg-block" aria-label="Search website">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <circle cx="10" cy="10" r="7"></circle>
            <line x1="21" y1="21" x2="15" y2="15"></line>
          </svg>
        </button>
        
        
        
        <button id="buttonColorMode" class="btn btn-link mx-auto nav-link p-0 ms-lg-2 me-lg-1" type="button" aria-label="Toggle theme">
          <svg data-bs-theme-value="dark" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
          </svg>
          <svg data-bs-theme-value="light" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-sun" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <path d="M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0m-5 0h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7"></path>
          </svg>
        </button>
        
        <ul id="socialMenu" class="nav mx-auto flex-row order-lg-4">
          <li class="nav-item">
              <a class="nav-link social-link" href="https://github.com/ltdungg"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"></path></svg><small class="ms-2 visually-hidden">GitHub</small></a>
            </li>
          </ul>
        
        </div>
    </div>

    
    </div>
</header>
</div>

<div class="modal" id="searchModal" tabindex="-1" aria-labelledby="searchModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-fullscreen-md-down">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5 visually-hidden" id="searchModalLabel">Search</h1>
        <button type="button" class="btn-close visually-hidden" data-bs-dismiss="modal" aria-label="Close"></button>
        <div class="search-input flex-grow-1 d-none">
          <form id="search-form" class="search-form" action="#" method="post" accept-charset="UTF-8" role="search">
            <label for="query" class="visually-hidden">Search</label>
            <div class="d-flex">
              <input type="search" id="query" name="query" class="search-text form-control form-control-lg" placeholder="Search" aria-label="Search" maxlength="128" autocomplete="off">
              <button type="button" class="btn btn-link text-decoration-none px-0 ms-3 d-md-none" data-bs-dismiss="modal" aria-label="Close">Cancel</button>
            </div>
          </form>
        </div>
      </div>
      <div class="modal-body">
        <p class="search-loading status message d-none mt-3 text-center">Loading search index…</p>
        <p class="search-no-recent message d-none mt-3 text-center">No recent searches</p>
        <p class="search-no-results message d-none mt-3 text-center">No results for "<strong><span class="query-no-results">Query here</span></strong>"</p>
        <div id="searchResults" class="search-results"></div>
        <template>
          <article class="search-result list-view">
            <div class="card my-3">
              <div class="card-body">
                <header>
                  <h2 class="h5 title title-submitted mb-0"><a class="stretched-link text-decoration-none text-reset" href="#">Title here</a></h2>
                  <div class="submitted d-none"><time class="created-date">Date here</time></div>
                </header>
                <div class="content">Summary here</div>
              </div>
            </div>
          </article>
        </template>
      </div>
      <div class="modal-footer">
        <ul class="list-inline me-auto d-none d-md-block">
          <li class="list-inline-item"><kbd class="me-2"><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4M7 11.53088l-3-3 3-3"></path></g></svg></kbd><span class="DocSearch-Label">to select</span></li>
          <li class="list-inline-item"><kbd class="me-2"><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8M10.5 8.5l-3 3-3-3"></path></g></svg></kbd><kbd class="me-2"><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8M10.5 6.5l-3-3-3 3"></path></g></svg></kbd><span class="DocSearch-Label">to navigate</span></li>
          <li class="list-inline-item"><kbd class="me-2"><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993 0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016.8634 0 1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5c.032.5663-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864 0 1.6425 1.031 1.5443 2.2492h-2.956"></path></g></svg></kbd><span class="DocSearch-Label">to close</span></li>
        </ul>
        <p class="d-md-none">Search by <a class="text-decoration-none" href="https://github.com/nextapps-de/flexsearch">FlexSearch</a></p>
      </div>
    </div>
  </div>
</div>


    <div class="wrap container-lg" role="document">
      <div class="content">
      
        
	<div class="row flex-xl-nowrap">
		<div class="col-lg-5 col-xl-4 docs-sidebar docs-sidebar-offset d-none d-lg-block">
			
  
    
<nav class="section-nav docs-links">
  <ul class="list-unstyled">

  <li>
    <details open>
      <summary>Giới thiệu</summary>
      <ul class="list-unstyled list-nested">

  <li>
      <a href="/de-docs/overview/loi-mo-dau/">Lời mở đầu</a>
  </li>
      </ul>
    </details>
  </li>

  <li>
    <details open>
      <summary>Data Engineer Cơ Bản</summary>
      <ul class="list-unstyled list-nested">

  <li>
      <a href="/de-docs/de-basic/1-gioi-thieu-ve-de/">Giới thiệu về Data Engineer</a>
  </li>

  <li>
      <a href="/de-docs/de-basic/2-data-management-architecture/">Data Management Architectures</a>
  </li>

  <li>
    <details open>
      <summary>Data Warehouse</summary>
      <ul class="list-unstyled list-nested">

  <li>
      <a href="/de-docs/de-basic/datawarehouse/data-warehouse-basic/">Data Warehouse cơ bản</a>
  </li>

  <li>
      <a href="/de-docs/de-basic/datawarehouse/dtamsp/">Kho dữ liệu phân tán và xử lý dữ liệu song song</a>
  </li>

  <li>
      <a href="/de-docs/de-basic/datawarehouse/columnar-data-storage/">Columnar Data Storage And Data Compression</a>
  </li>

  <li>
      <a href="/de-docs/de-basic/datawarehouse/etl-elt-pipelines/">ETL and ELT pipelines</a>
  </li>
      </ul>
    </details>
  </li>

  <li>
    <details open>
      <summary>Data Lake</summary>
      <ul class="list-unstyled list-nested">

  <li>
      <a href="/de-docs/de-basic/datalake/overview/">Data Lake cơ bản</a>
  </li>
      </ul>
    </details>
  </li>

  <li>
    <details open>
      <summary>Data Lakehouse</summary>
      <ul class="list-unstyled list-nested">

  <li>
      <a href="/de-docs/de-basic/datalakehouse/overview/">Data lakehouse cơ bản</a>
  </li>
      </ul>
    </details>
  </li>

  <li>
    <details open>
      <summary>AWS for Ingesting Data</summary>
      <ul class="list-unstyled list-nested">

  <li>
      <a href="/de-docs/de-basic/ingestion-tool/overview/">Giới thiệu</a>
  </li>

  <li>
      <a href="/de-docs/de-basic/ingestion-tool/amazon-dms/">Amazon Database Migration Service</a>
  </li>

  <li>
      <a href="/de-docs/de-basic/ingestion-tool/amazon-kinesis/">Amazon Kinesis for streaming data ingestion</a>
  </li>
      </ul>
    </details>
  </li>
      </ul>
    </details>
  </li>

  <li>
    <details open open>
      <summary>Mở đầu về Spark</summary>
      <ul class="list-unstyled list-nested">

  <li>
      <a href="/de-docs/spark/khai-niem/">1. Giới thiệu về Spark</a>
  </li>

  <li>
      <a href="/de-docs/spark/thanh-phan-cua-spark/">2. Thành phần của Spark</a>
  </li>

  <li>
      <a href="/de-docs/spark/cach-hoat-dong/">3. Cách Spark hoạt động</a>
  </li>

  <li>
      <a href="/de-docs/spark/spark-application-concept/">4. Các khái niệm Spark Application</a>
  </li>

  <li class="active" >
      <a aria-current="page" href="/de-docs/spark/dataframe-api/">5. DataFrame API</a>
  </li>

  <li>
      <a href="/de-docs/spark/common-dataframe-operation/">6. Một số thao tác với DataFrame</a>
  </li>

  <li>
      <a href="/de-docs/spark/bai-tap-lan-mot/">7. Bài tập DataFrame lần 1</a>
  </li>
      </ul>
    </details>
  </li>

  <li>
    <details open>
      <summary>Mở đầu về Kafka</summary>
      <ul class="list-unstyled list-nested">

  <li>
      <a href="/de-docs/kafka/overview/">Giới thiệu về Kafka</a>
  </li>
      </ul>
    </details>
  </li>
  </ul>
</nav>

  

		</div>
		
		<nav class="docs-toc docs-toc-offset d-none d-xl-block col-xl-3" aria-label="Secondary navigation">
			<div class="page-links">
  <h3>On this page</h3>
    <nav id="toc">
  <ul>
    <li>
      <ul>
        <li><a href="#sparks-basic-data-types">Spark&rsquo;s Basic Data Types</a></li>
        <li><a href="#sparks-structured-and-complex-data-types">Spark&rsquo;s Structured and Complex Data Types</a></li>
        <li><a href="#schemas-and-creating-dataframes">Schemas and Creating DataFrames</a></li>
        <li><a href="#columns-and-expression">Columns and Expression</a></li>
        <li><a href="#rows">Rows</a></li>
      </ul>
    </li>
  </ul>
</nav>
</div>

		</nav>
		<main class="docs-content col-lg-11 col-xl-9">
		
			<h1>5. DataFrame API</h1>
			
			<nav class="toc-mobile d-xl-none" aria-label="Quaternary navigation">
				<details>
    <summary>On this page</summary>
    <div class="page-links">
      <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#sparks-basic-data-types">Spark&rsquo;s Basic Data Types</a></li>
        <li><a href="#sparks-structured-and-complex-data-types">Spark&rsquo;s Structured and Complex Data Types</a></li>
        <li><a href="#schemas-and-creating-dataframes">Schemas and Creating DataFrames</a></li>
        <li><a href="#columns-and-expression">Columns and Expression</a></li>
        <li><a href="#rows">Rows</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
  </details>

			</nav>
			<style>body {text-align: justify}</style>
<p>Spark DataFrame được lấy cảm hứng từ pandas DataFrame về cấu trúc, định dạng và một số thao tác cụ thể. Ví dụ về một Spark DataFrame được hiển thị tại Hình 1.</p>
<p>

<img
  src="/de-docs/spark/images/dataframe-example_hu_504eb13c67cbae59.webp"
  width="723"
  height="246"
  decoding="async"
  fetchpriority="auto"
  loading="lazy"
  alt="alt"id="h-rh-i-0"
/>
<em>Hình 1: Table-like format of a DataFrame</em></p>
<p>DataFrame trong Spark bất biến và Spark giữ lại và theo dõi tất cả các transformations (Được nêu ở phần 4). Vì thế bạn có thể sửa đổi tên hoặc data types của cột, tạo DataFrame mới mà bản cũ vẫn được bảo tồn.</p>
<h3 id="sparks-basic-data-types">Spark&rsquo;s Basic Data Types<a href="#sparks-basic-data-types" class="anchor" aria-hidden="true">#</a> </h3>
<p>Những data types cơ bản có trong Python cũng được Spark hỗ trợ. Ví dụ như Hình 2 dưới đây.</p>
<p>

<img
  src="/de-docs/spark/images/spark-python-datatypes_hu_bc0ec888a9cdc263.webp"
  width="474"
  height="270"
  decoding="async"
  fetchpriority="auto"
  loading="lazy"
  alt="alt"id="h-rh-i-1"
/>
<br>
<em>Hình 2: Basic Python data types in Spark</em></p>
<h3 id="sparks-structured-and-complex-data-types">Spark&rsquo;s Structured and Complex Data Types<a href="#sparks-structured-and-complex-data-types" class="anchor" aria-hidden="true">#</a> </h3>
<p>Để dùng cho những việc phân tích phức tạp, bạn không chỉ đối mặt với những kiểu dữ liệu cơ bản trên. Mà dữ liệu của bạn sẽ phức tạp hơn, thường có cấu trúc hoặc lồng nhau.
Vì vậy, bạn cần Spark có thể xử lý được những kiểu dữ liệu phức tạp đó. Có thể như: maps, arrays, structs, dates, timestamps, fields,&hellip;</p>
<p>Trong Python, các kiểu dữ liệu tương đương cũng được Spark hỗ trợ, ví dụ</p>
<p>

<img
  src="/de-docs/spark/images/spark-complex-datatypes_hu_ee5d4d3a426e6755.webp"
  width="719"
  height="260"
  decoding="async"
  fetchpriority="auto"
  loading="lazy"
  alt="alt"id="h-rh-i-2"
/>
<em>Hình 3: Python structured data in Spark</em></p>
<h3 id="schemas-and-creating-dataframes">Schemas and Creating DataFrames<a href="#schemas-and-creating-dataframes" class="anchor" aria-hidden="true">#</a> </h3>
<p>Một schema trong Spark xác định tên cột và liên kết với kiểu dữ liệu cho một DataFrame. Schema thường được sử dụng khi đọc dữ liệu có cáu trúc từ nguồn dữ liệu bên ngoài.
<br>
<br>
Tác dụng của Schema:</p>
<ul>
<li>Giúp Spark có thể tránh khỏi việc tự suy luận ra kiểu dữ liệu.</li>
<li>Giúp Spark ngăn chặn việc tạo một công việc riêng để đọc một khối lượng lớn dữ liệu để xác định ra lược đồ (schema). Với một lượng dữ liệu lớn, điều này có thể gây tốn kém và tốn thời gian.</li>
<li>Bạn có thể phát hiện lỗi sớm nếu dữ liệu không khớp với lược đồ (schema).</li>
</ul>
<h5 id="có-2-cách-để-định-nghĩa-một-schema">Có 2 cách để định nghĩa một schema<a href="#có-2-cách-để-định-nghĩa-một-schema" class="anchor" aria-hidden="true">#</a> </h5>
<p><strong>Một là,</strong> định nghĩa một cách rất lập trình (programmatically). <br>
<strong>Hai là,</strong> triển khai một DDL (Data Definition Language) String, cách này đơn giản và dễ đọc hơn.
<br>
<br>
Để định nghĩa một schema programmatically cho một DataFrame với 3 cột: author, title và pages, bạn có thể sử dụng Spark DataFrame API. Ví dụ:</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="c1">// In Scala
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">import</span> <span class="nn">org.apache.spark.sql.types._</span>
</span></span><span class="line"><span class="cl"><span class="k">val</span> <span class="n">schema</span> <span class="k">=</span> <span class="nc">StructType</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="nc">StructField</span><span class="o">(</span><span class="s">&#34;author&#34;</span><span class="o">,</span> <span class="nc">StringType</span><span class="o">,</span> <span class="kc">false</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">                              <span class="nc">StructField</span><span class="o">(</span><span class="s">&#34;title&#34;</span><span class="o">,</span> <span class="nc">StringField</span><span class="o">,</span> <span class="kc">false</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">                              <span class="nc">StructField</span><span class="o">(</span><span class="s">&#34;pages&#34;</span><span class="o">,</span> <span class="nc">IntegerType</span><span class="o">,</span> <span class="kc">false</span><span class="o">)))</span></span></span></code></pre></div>
  </figure>
</div>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># In Python</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pyspark.sql.types</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">schema</span> <span class="o">=</span> <span class="n">StructType</span><span class="p">([</span><span class="n">StructField</span><span class="p">(</span><span class="s2">&#34;author&#34;</span><span class="p">,</span> <span class="n">StringType</span><span class="p">(),</span> <span class="kc">False</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                     <span class="n">StructField</span><span class="p">(</span><span class="s2">&#34;title&#34;</span><span class="p">,</span> <span class="n">StringType</span><span class="p">(),</span> <span class="kc">False</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                     <span class="n">StructField</span><span class="p">(</span><span class="s2">&#34;pages&#34;</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">(),</span> <span class="kc">False</span><span class="p">)])</span></span></span></code></pre></div>
  </figure>
</div>
<p>Cách định nghĩa thứ 2 sử dụng DDL đơn giản hơn rất nhiều, ví dụ:</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="c1">// In Scala
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">val</span> <span class="n">schema</span> <span class="k">=</span> <span class="s">&#34;author STRING, title STRING, pages INT&#34;</span></span></span></code></pre></div>
  </figure>
</div>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># In Python</span>
</span></span><span class="line"><span class="cl"><span class="n">schema</span> <span class="o">=</span> <span class="s2">&#34;author STRING, title STRING, pages INT&#34;</span></span></span></code></pre></div>
  </figure>
</div>
<p>Bạn có thể chọn cách định nghĩa schema tùy thích.</p>
<p><strong>Ví dụ:</strong> Tạo SparkSession và xác định lược đồ và thêm dữ liệu vào trong DataFrame.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># In Python</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Example-3_6.py</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">SparkSession</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Xác định lược đồ của dữ liệu bằng DDL</span>
</span></span><span class="line"><span class="cl"><span class="n">schema</span> <span class="o">=</span> <span class="s2">&#34;`Id` INT, `First` STRING, `Url` STRING, `Published` STRING, `Hits` INT, `Campaigns` ARRAY&lt;STRING&gt;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Tạo static data</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&#34;Jules&#34;</span><span class="p">,</span> <span class="s2">&#34;Damji&#34;</span><span class="p">,</span> <span class="s2">&#34;https://tinyurl.1&#34;</span><span class="p">,</span> <span class="s2">&#34;1/4/2016&#34;</span><span class="p">,</span> <span class="mi">4535</span><span class="p">,</span> <span class="p">[</span><span class="s2">&#34;twitter&#34;</span><span class="p">,</span> <span class="s2">&#34;LinkedIn&#34;</span><span class="p">]],</span>
</span></span><span class="line"><span class="cl">       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&#34;Brooke&#34;</span><span class="p">,</span><span class="s2">&#34;Wenig&#34;</span><span class="p">,</span> <span class="s2">&#34;https://tinyurl.2&#34;</span><span class="p">,</span> <span class="s2">&#34;5/5/2018&#34;</span><span class="p">,</span> <span class="mi">8908</span><span class="p">,</span> <span class="p">[</span><span class="s2">&#34;twitter&#34;</span><span class="p">,</span><span class="s2">&#34;LinkedIn&#34;</span><span class="p">]],</span>
</span></span><span class="line"><span class="cl">       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&#34;Denny&#34;</span><span class="p">,</span> <span class="s2">&#34;Lee&#34;</span><span class="p">,</span> <span class="s2">&#34;https://tinyurl.3&#34;</span><span class="p">,</span> <span class="s2">&#34;6/7/2019&#34;</span><span class="p">,</span> <span class="mi">7659</span><span class="p">,</span> <span class="p">[</span><span class="s2">&#34;web&#34;</span><span class="p">,</span> <span class="s2">&#34;twitter&#34;</span><span class="p">,</span> <span class="s2">&#34;FB&#34;</span><span class="p">,</span> <span class="s2">&#34;LinkedIn&#34;</span><span class="p">]],</span>
</span></span><span class="line"><span class="cl">       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&#34;Tathagata&#34;</span><span class="p">,</span> <span class="s2">&#34;Das&#34;</span><span class="p">,</span> <span class="s2">&#34;https://tinyurl.4&#34;</span><span class="p">,</span> <span class="s2">&#34;5/12/2018&#34;</span><span class="p">,</span> <span class="mi">10568</span><span class="p">,</span> <span class="p">[</span><span class="s2">&#34;twitter&#34;</span><span class="p">,</span> <span class="s2">&#34;FB&#34;</span><span class="p">]],</span>
</span></span><span class="line"><span class="cl">       <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&#34;Matei&#34;</span><span class="p">,</span><span class="s2">&#34;Zaharia&#34;</span><span class="p">,</span> <span class="s2">&#34;https://tinyurl.5&#34;</span><span class="p">,</span> <span class="s2">&#34;5/14/2014&#34;</span><span class="p">,</span> <span class="mi">40578</span><span class="p">,</span> <span class="p">[</span><span class="s2">&#34;web&#34;</span><span class="p">,</span> <span class="s2">&#34;twitter&#34;</span><span class="p">,</span> <span class="s2">&#34;FB&#34;</span><span class="p">,</span> <span class="s2">&#34;LinkedIn&#34;</span><span class="p">]],</span>
</span></span><span class="line"><span class="cl">       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="s2">&#34;Reynold&#34;</span><span class="p">,</span> <span class="s2">&#34;Xin&#34;</span><span class="p">,</span> <span class="s2">&#34;https://tinyurl.6&#34;</span><span class="p">,</span> <span class="s2">&#34;3/2/2015&#34;</span><span class="p">,</span> <span class="mi">25568</span><span class="p">,</span> <span class="p">[</span><span class="s2">&#34;twitter&#34;</span><span class="p">,</span> <span class="s2">&#34;LinkedIn&#34;</span><span class="p">]]]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Hàm chính</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Khởi tạo SparkSession</span>
</span></span><span class="line"><span class="cl">    <span class="n">spark</span> <span class="o">=</span> <span class="p">(</span><span class="n">SparkSession</span>
</span></span><span class="line"><span class="cl">             <span class="o">.</span><span class="n">builder</span>
</span></span><span class="line"><span class="cl">             <span class="o">.</span><span class="n">appName</span><span class="p">(</span><span class="s2">&#34;CreatingDataFrame&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">             <span class="o">.</span><span class="n">getOrCreate</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Tạo một DataFrame bằng schema đã được định nghĩa </span>
</span></span><span class="line"><span class="cl">    <span class="n">blogs_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Hiển thị DataFrame</span>
</span></span><span class="line"><span class="cl">    <span class="n">blogs_df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Hiển thị schema</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">blogs_df</span><span class="o">.</span><span class="n">printSchema</span><span class="p">())</span></span></span></code></pre></div>
  </figure>
</div>
<p>Chạy chương trình trong console sẽ được output như sau:</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> spark-submit Example-3_6.py
</span></span><span class="line"><span class="cl"><span class="go">...
</span></span></span><span class="line"><span class="cl"><span class="go">+-------+---------+-------+-----------------+---------+-----+------------------+
</span></span></span><span class="line"><span class="cl"><span class="go">|Id     |First    |Last   |Url              |Published|Hits |Campaigns         |
</span></span></span><span class="line"><span class="cl"><span class="go">+-------+---------+-------+-----------------+---------+-----+------------------+
</span></span></span><span class="line"><span class="cl"><span class="go">|1      |Jules    |Damji  |https://tinyurl.1|1/4/2016 |4535 |[twitter,...]     |
</span></span></span><span class="line"><span class="cl"><span class="go">|2      |Brooke   |Wenig  |https://tinyurl.2|5/5/2018 |8908 |[twitter,...]     |
</span></span></span><span class="line"><span class="cl"><span class="go">|3      |Denny    |Lee    |https://tinyurl.3|6/7/2019 |7659 |[web, twitter...] |
</span></span></span><span class="line"><span class="cl"><span class="go">|4      |Tathagata|Das    |https://tinyurl.4|5/12/2018|10568|[twitter, FB]     |
</span></span></span><span class="line"><span class="cl"><span class="go">|5      |Matei    |Zaharia|https://tinyurl.5|5/14/2014|40578|[web, twitter,...]|
</span></span></span><span class="line"><span class="cl"><span class="go">|6      |Reynold  |Xin    |https://tinyurl.6|3/2/2015 |25568|[twitter,...]     |
</span></span></span><span class="line"><span class="cl"><span class="go">+-------+---------+-------+-----------------+---------+-----+------------------+
</span></span></span><span class="line"><span class="cl"><span class="go">root
</span></span></span><span class="line"><span class="cl"><span class="go">|-- Id: integer (nullable = false)
</span></span></span><span class="line"><span class="cl"><span class="go">|-- First: string (nullable = false)
</span></span></span><span class="line"><span class="cl"><span class="go">|-- Last: string (nullable = false)
</span></span></span><span class="line"><span class="cl"><span class="go">|-- Url: string (nullable = false)
</span></span></span><span class="line"><span class="cl"><span class="go">|-- Published: string (nullable = false)
</span></span></span><span class="line"><span class="cl"><span class="go">|-- Hits: integer (nullable = false)
</span></span></span><span class="line"><span class="cl"><span class="go">|-- Campaigns: array (nullable = false)
</span></span></span><span class="line"><span class="cl"><span class="go">| |-- element: string (containsNull = false)
</span></span></span></code></pre></div>
  </figure>
</div>
<h3 id="columns-and-expression">Columns and Expression<a href="#columns-and-expression" class="anchor" aria-hidden="true">#</a> </h3>
<p>Có thể sử dụng biểu thức toán học, logic lên các cột. Ví dụ bạn có thể tạo một biểu thức cơ bản sử dụng <em>expr(&ldquo;ColumnName&rdquo; * 5)</em> hoặc <em>(expr(&ldquo;columnName&rdquo;) - 5 &gt; col(anotherColumnName))</em>.
<br>
<br>
Câu lệnh expr() là một phần gói của <em>pyspark.sql.functions</em> (Python) và <em>org.apache.spark.sql.functions</em> (Scala). Câu lệnh này lấy đối số mà Spark có thể phân tích thành biểu thức và tính toán ra kết quả.</p>
<blockquote>
<p><strong><em>NOTE:</em></strong>  Cả Scala, Java, Python đều có một phương thức public liên kết với cột. Trong Spark document đề cập đến col và Column. Column là tên của đối tượng, còn col() là một hàm để trả về một Column.</p></blockquote>
<p>Bạn hãy xem ví dụ dưới đây để thấy được chúng ta có thể làm gì với cột trong Spark.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="c1">// In Scala
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">org.apache.spark.sql.functions._</span>
</span></span><span class="line"><span class="cl"><span class="n">scala</span><span class="o">&gt;</span> <span class="n">blogsDF</span><span class="o">.</span><span class="n">columns</span>
</span></span><span class="line"><span class="cl"><span class="n">res2</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="nc">Campaigns</span><span class="o">,</span> <span class="nc">First</span><span class="o">,</span> <span class="nc">Hits</span><span class="o">,</span> <span class="nc">Id</span><span class="o">,</span> <span class="nc">Last</span><span class="o">,</span> <span class="nc">Published</span><span class="o">,</span> <span class="nc">Url</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Truy cập một cột cụ thể và trả về loại Cột
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">scala</span><span class="o">&gt;</span> <span class="n">blogsDF</span><span class="o">.</span><span class="n">cols</span><span class="o">(</span><span class="s">&#34;Id&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="n">res3</span><span class="k">:</span> <span class="kt">org.apache.spark.sql.Column</span> <span class="o">=</span> <span class="n">id</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Sử dụng biểu thức để tính toán
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">scala</span><span class="o">&gt;</span> <span class="n">blogsDF</span><span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="n">expr</span><span class="o">(</span><span class="s">&#34;Hits * 2&#34;</span><span class="o">)).</span><span class="n">show</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Hoặc sử dụng col() để tính toán giá trị cùng kết quả với câu lệnh trên
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">scala</span><span class="o">&gt;</span> <span class="n">blogsDF</span><span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="n">col</span><span class="o">(</span><span class="s">&#34;Hits&#34;</span><span class="o">)</span> <span class="o">*</span> <span class="mi">2</span><span class="o">).</span><span class="n">show</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">+----------+</span>
</span></span><span class="line"><span class="cl"><span class="o">|(</span><span class="nc">Hits</span> <span class="o">*</span> <span class="mi">2</span><span class="o">)|</span>
</span></span><span class="line"><span class="cl"><span class="o">+----------+</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="mi">9070</span>     <span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="mi">17816</span>    <span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">+----------+</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Sử dụng biểu thức để tính toán những người nổi tiếng về blog
</span></span></span><span class="line"><span class="cl"><span class="c1">// Câu lệnh này sẽ tạo ra cột mới, tên &#34;Big Hitters&#34;, dựa trên biểu thức điều kiện
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="n">blogsDF</span><span class="o">.</span><span class="n">withColumn</span><span class="o">(</span><span class="s">&#34;Big Hitters&#34;</span><span class="o">,</span> <span class="o">(</span><span class="n">expr</span><span class="o">(</span><span class="s">&#34;Hits &gt; 10000&#34;</span><span class="o">))).</span><span class="n">show</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nc">Output</span><span class="k">:</span>
</span></span><span class="line"><span class="cl"><span class="kt">+---+---------+-------+---+---------+-----+--------------------+-----------+</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="nc">Id</span><span class="o">|</span> <span class="nc">First</span>   <span class="o">|</span> <span class="nc">Last</span>  <span class="o">|</span><span class="nc">Url</span><span class="o">|</span><span class="nc">Published</span><span class="o">|</span> <span class="nc">Hits</span><span class="o">|</span> <span class="nc">Campaigns</span>          <span class="o">|</span><span class="nc">Big</span> <span class="nc">Hitters</span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">+---+---------+-------+---+---------+-----+--------------------+-----------+</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="mi">1</span> <span class="o">|</span> <span class="nc">Jules</span>   <span class="o">|</span> <span class="nc">Damji</span> <span class="o">|...|</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">/</span><span class="mi">2016</span><span class="o">|</span> <span class="mi">4535</span><span class="o">|</span> <span class="o">[</span><span class="kt">twitter</span>, <span class="kt">LinkedIn</span><span class="o">]|</span> <span class="kc">false</span>     <span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="mi">2</span> <span class="o">|</span> <span class="nc">Brooke</span>  <span class="o">|</span> <span class="nc">Wenig</span> <span class="o">|...|</span> <span class="mi">5</span><span class="o">/</span><span class="mi">5</span><span class="o">/</span><span class="mi">2018</span><span class="o">|</span> <span class="mi">8908</span><span class="o">|</span> <span class="o">[</span><span class="kt">twitter</span>, <span class="kt">LinkedIn</span><span class="o">]|</span> <span class="kc">false</span>     <span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="mi">3</span> <span class="o">|</span> <span class="nc">Denny</span>   <span class="o">|</span> <span class="nc">Lee</span>   <span class="o">|...|</span> <span class="mi">6</span><span class="o">/</span><span class="mi">7</span><span class="o">/</span><span class="mi">2019</span><span class="o">|</span> <span class="mi">7659</span><span class="o">|[</span><span class="kt">web</span>, <span class="kt">twitter</span>, <span class="kt">FB...|</span> <span class="kt">false</span>     <span class="kt">|</span>
</span></span><span class="line"><span class="cl"><span class="kt">|</span> <span class="err">4</span> <span class="kt">|Tathagata|</span> <span class="kt">Das</span>   <span class="kt">|...|</span><span class="err">5</span><span class="kt">/</span><span class="err">12</span><span class="kt">/</span><span class="err">2018</span><span class="kt">|</span><span class="err">10568</span><span class="kt">|</span> <span class="o">[</span><span class="kt">twitter</span>, <span class="kt">FB</span><span class="o">]</span>      <span class="kt">|</span> <span class="kt">true</span>      <span class="kt">|</span>
</span></span><span class="line"><span class="cl"><span class="kt">|</span> <span class="err">5</span> <span class="kt">|</span> <span class="kt">Matei</span>   <span class="kt">|Zaharia|...|</span><span class="err">5</span><span class="kt">/</span><span class="err">14</span><span class="kt">/</span><span class="err">2014</span><span class="kt">|</span><span class="err">40578</span><span class="kt">|</span><span class="o">[</span><span class="kt">web</span>, <span class="kt">twitter</span>, <span class="kt">FB...|</span> <span class="kt">true</span>      <span class="kt">|</span>
</span></span><span class="line"><span class="cl"><span class="kt">|</span> <span class="err">6</span> <span class="kt">|</span> <span class="kt">Reynold</span> <span class="kt">|</span> <span class="kt">Xin</span>   <span class="kt">|...|</span> <span class="err">3</span><span class="kt">/</span><span class="err">2</span><span class="kt">/</span><span class="err">2015</span><span class="kt">|</span><span class="err">25568</span><span class="kt">|</span> <span class="o">[</span><span class="kt">twitter</span>, <span class="kt">LinkedIn</span><span class="o">]</span><span class="kt">|</span> <span class="kt">true</span>      <span class="kt">|</span>
</span></span><span class="line"><span class="cl"><span class="kt">+---+---------+-------+---+---------+-----+--------------------+-----------+</span></span></span></code></pre></div>
  </figure>
</div>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="c1">// Kết hợp 3 cột, tạo cột mới và hiển thị.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">blogsDF</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">withColumn</span><span class="o">(</span><span class="s">&#34;AuthorsId&#34;</span><span class="o">,</span> <span class="o">(</span><span class="n">concat</span><span class="o">(</span><span class="n">expr</span><span class="o">(</span><span class="s">&#34;First&#34;</span><span class="o">),</span> <span class="n">expr</span><span class="o">(</span><span class="s">&#34;Last&#34;</span><span class="o">),</span> <span class="n">expr</span><span class="o">(</span><span class="s">&#34;Id&#34;</span><span class="o">))))</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="n">col</span><span class="o">(</span><span class="err">&#34;</span><span class="nc">AuthorsId</span><span class="o">))</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">show</span><span class="o">(</span><span class="mi">4</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nc">Output</span><span class="k">:</span>
</span></span><span class="line"><span class="cl"><span class="kt">+-------------+</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="nc">AuthorsId</span>   <span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">+-------------+</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="nc">JulesDamji1</span> <span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="nc">BrookeWenig2</span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="nc">DennyLee3</span>   <span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="nc">TathagataDas4</span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">+-------------+</span></span></span></code></pre></div>
  </figure>
</div>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="c1">// Những câu lệnh dưới đây cùng trả về chung giá trị:
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">blogsDF</span><span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="n">expr</span><span class="o">(</span><span class="s">&#34;Hits&#34;</span><span class="o">)).</span><span class="n">show</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="n">blogsDF</span><span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="n">col</span><span class="o">(</span><span class="s">&#34;Hits&#34;</span><span class="o">)).</span><span class="n">show</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="n">blogsDF</span><span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="s">&#34;Hits&#34;</span><span class="o">).</span><span class="n">show</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span></span></span></code></pre></div>
  </figure>
</div>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="c1">// Sắp xếp giảm dần cột &#34;Id&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">blogsDF</span><span class="o">.</span><span class="n">sort</span><span class="o">(</span><span class="n">col</span><span class="o">(</span><span class="s">&#34;Id&#34;</span><span class="o">).</span><span class="n">desc</span><span class="o">).</span><span class="n">show</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="n">blogsDF</span><span class="o">.</span><span class="n">sort</span><span class="o">(</span><span class="n">$</span><span class="s">&#34;Id&#34;</span><span class="o">.</span><span class="n">desc</span><span class="o">).</span><span class="n">show</span><span class="o">()</span></span></span></code></pre></div>
  </figure>
</div>
<p>Trong ví dụ cuối, col(&ldquo;Id&rdquo;.desc) và $&ldquo;Id&rdquo;.desc đều giống nhau. Đều sắp xếp cột có tên &ldquo;Id&rdquo; theo thứ tự giảm dần. Trong đó:</p>
<ul>
<li>col(&ldquo;Id&rdquo;) trả về một Column object</li>
<li>Còn sử dụng $ trước tên cột sẽ chuyển đổi tên cột thành Column.</li>
</ul>
<h3 id="rows">Rows<a href="#rows" class="anchor" aria-hidden="true">#</a> </h3>
<p>Một hàng trong Spark chứa một hay nhiều cột. Bạn có thể khởi tạo một Row trong Spark hay truy cập vào các field của nó bằng index bắt đầu từ 0:</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="c1">// In Scala
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">import</span> <span class="nn">org.apache.spark.sql.Row</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Tạo một Row
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">val</span> <span class="n">blogRow</span> <span class="k">=</span> <span class="nc">Row</span><span class="o">(</span><span class="mi">6</span><span class="o">,</span> <span class="s">&#34;Reynold&#34;</span><span class="o">,</span> <span class="s">&#34;Xin&#34;</span><span class="o">,</span> <span class="s">&#34;https://tinyurl.6&#34;</span><span class="o">,</span> <span class="mi">255568</span><span class="o">,</span> <span class="s">&#34;3/2/2015&#34;</span><span class="o">,</span> <span class="nc">Array</span><span class="o">(</span><span class="s">&#34;twitter&#34;</span><span class="o">,</span> <span class="s">&#34;LinkedIn&#34;</span><span class="o">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Truy cập bằng index
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">scala</span><span class="o">&gt;</span> <span class="n">blogRow</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="n">res</span><span class="k">:</span> <span class="kt">Any</span> <span class="o">=</span> <span class="nc">Reynold</span></span></span></code></pre></div>
  </figure>
</div>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># In Python</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">Row</span>
</span></span><span class="line"><span class="cl"><span class="n">blog_row</span> <span class="o">=</span> <span class="n">Row</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s2">&#34;Reynold&#34;</span><span class="p">,</span> <span class="s2">&#34;Xin&#34;</span><span class="p">,</span> <span class="s2">&#34;https://tinyurl.6&#34;</span><span class="p">,</span> <span class="mi">255568</span><span class="p">,</span> <span class="s2">&#34;3/2/2015&#34;</span><span class="p">,[</span><span class="s2">&#34;twitter&#34;</span><span class="p">,</span> <span class="s2">&#34;LinkedIn&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Truy cập bằng index</span>
</span></span><span class="line"><span class="cl"><span class="n">blog_row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="s1">&#39;Reynold&#39;</span></span></span></code></pre></div>
  </figure>
</div>
<p>Row object có thể sử dụng để tạo DataFrame:</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># In Python</span>
</span></span><span class="line"><span class="cl"><span class="n">rows</span> <span class="o">=</span> <span class="p">[</span><span class="n">Row</span><span class="p">(</span><span class="s2">&#34;Matei Zaharia&#34;</span><span class="p">,</span> <span class="s2">&#34;CA&#34;</span><span class="p">),</span> <span class="n">Row</span><span class="p">(</span><span class="s2">&#34;Reynold Xin&#34;</span><span class="p">,</span> <span class="s2">&#34;CA&#34;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl"><span class="n">authors_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="p">[</span><span class="s2">&#34;Authors&#34;</span><span class="p">,</span> <span class="s2">&#34;State&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">authors_df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="o">+-------------+-----+</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="n">Author</span>      <span class="o">|</span><span class="n">State</span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">+-------------+-----+</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="n">Matei</span> <span class="n">Zaharia</span><span class="o">|</span> <span class="n">CA</span>  <span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="n">Reynold</span> <span class="n">Xin</span> <span class="o">|</span> <span class="n">CA</span>  <span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">+-------------+-----+</span></span></span></code></pre></div>
  </figure>
</div>

			<div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between">
				</div>
			<div class="page-nav d-flex flex-column flex-sm-row">
	
	<div class="card w-100">
			<div class="card-body d-flex">
				<div class="d-flex flex-column justify-content-center">
					<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-left" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
						<path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
						<path d="M5 12l14 0"></path>
						<path d="M5 12l6 6"></path>
						<path d="M5 12l6 -6"></path>
				 	</svg>
				</div>
				<div class="d-flex flex-column">
					<div class="text-body-secondary">Prev</div>
					<a href="/de-docs/spark/spark-application-concept/" class="stretched-link text-reset text-decoration-none">4. Các khái niệm Spark Application</a>
				</div>
			</div>
		</div>
	<div class="m-2"></div>
	<div class="card text-end w-100">
			<div class="card-body d-flex justify-content-end">
				<div class="d-flex flex-column">
					<div class="text-body-secondary">Next</div>
					<a href="/de-docs/spark/common-dataframe-operation/" class="stretched-link text-reset text-decoration-none">6. Một số thao tác với DataFrame</a>
				</div>
				<div class="d-flex flex-column justify-content-center">
					<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-right" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
						<path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
						<path d="M5 12l14 0"></path>
						<path d="M13 18l6 -6"></path>
						<path d="M13 6l6 6"></path>
					</svg>
				</div>
			</div>
		</div>
	</div>

			
		</main>
		
	</div>

      
      </div>
    </div>
    
    
    <footer class="footer text-muted">
  <div class="container-lg">
    <div class="row">
      <div class="col-lg-8 text-center text-lg-start">
        <ul class="list-inline">
          <li class="list-inline-item"><a class="text-muted" href="/privacy/">Privacy Policy</a></li>
        </ul>
      </div>
      <div class="col-lg-8 text-center text-lg-end">
        <ul class="list-inline">
          <li class="list-inline-item">Được tạo bởi Dũng Lương</li>
        </ul>
      </div>
    </div>
  </div>
</footer>

    

<script async
  src="/js/app.70b4fc255213028d0754da1f19e3048ceb95f97b9f3dba08cec9b12e1f89c3a0.js"
  integrity="sha256-cLT8JVITAo0HVNofGeMEjOuV&#43;XufPboIzsmxLh&#43;Jw6A=">
</script>





<script async
  src="/js/flexsearch.f5ccd5c9fcb1730536551bbcb7385a5c46d2ad164806184dd54a219982ee2c84.js"
  integrity="sha256-9czVyfyxcwU2VRu8tzhaXEbSrRZIBhhN1UohmYLuLIQ=">
</script>
<script async
  src="/js/search-modal.19d8681c7ab3f0ef428bde58a53831c073a4a4d405dafa3ed47b9063c8929768.js"
  integrity="sha256-GdhoHHqz8O9Ci95YpTgxwHOkpNQF2vo&#43;1HuQY8iSl2g=">
</script>

    
  </body>
</html>